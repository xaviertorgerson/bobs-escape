<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProLink // Davis Master Bath</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=IBM+Plex+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --pro-orange: #FF5722; --pro-carbon: #1A1A1B; --pro-blue: #2A4494; }
        body { font-family: 'Inter', sans-serif; background: #F4F4F2; color: var(--pro-carbon); overflow-x: hidden; }
        .mono { font-family: 'IBM Plex Mono', monospace; }
        
        .pro-card { background: white; border: 2px solid var(--pro-carbon); box-shadow: 6px 6px 0px var(--pro-carbon); position: relative; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .grid-bg { background-image: radial-gradient(#d1d1d1 0.8px, transparent 0.8px); background-size: 24px 24px; }
        
        .view-pane { display: none; animation: fadeIn 0.3s ease-out; }
        .view-pane.active { display: block; }
        
        .btn-main { background: var(--pro-orange); color: white; font-weight: 900; text-transform: uppercase; border: 2px solid var(--pro-carbon); box-shadow: 4px 4px 0px var(--pro-carbon); transition: 0.1s; cursor: pointer; text-align: center; width: 100%; display: block; }
        .btn-main:active { transform: translate(2px, 2px); box-shadow: 0px 0px 0px var(--pro-carbon); }
        
        /* Badges */
        .status-badge { font-family: 'IBM Plex Mono'; font-weight: 700; font-size: 10px; border: 2px solid; padding: 4px 10px; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s; }
        .badge-proposal { background: #F3F4F6; color: #374151; border-color: #374151; }
        .badge-progress { background: #DBEAFE; color: #1E40AF; border-color: #1E40AF; }
        .badge-complete { background: #DCFCE7; color: #166534; border-color: #166534; }

        /* Timeline */
        .timeline-container { position: relative; padding-left: 24px; }
        .timeline-line { position: absolute; left: 7px; top: 0; bottom: 0; width: 2px; background: var(--pro-carbon); opacity: 0.1; }
        .timeline-item { position: relative; padding-bottom: 32px; animation: fadeIn 0.5s ease-out forwards; }
        .timeline-dot { position: absolute; left: -21px; top: 4px; width: 12px; height: 12px; background: white; border: 2px solid var(--pro-carbon); border-radius: 50%; z-index: 10; }
        .dot-action { background: #22C55E; border-color: #166534; }
        .dot-photo { background: var(--pro-carbon); }
        .dot-msg { background: #3B82F6; border-color: #1E40AF; }

        .secure-tooltip { background: #F8FAFC; border: 1px solid #E2E8F0; padding: 12px; border-radius: 4px; display: flex; gap: 10px; }
        
        /* Animations */
        .teleport-out { transform: scale(0.9) translateY(20px); opacity: 0; pointer-events: none; }
        .log-entry-approved { border-left: 6px solid #22C55E !important; animation: slideIn 0.4s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="grid-bg pb-40">

    <nav class="bg-white border-b-2 border-black p-4 sticky top-0 z-50">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <span class="font-black text-xl italic uppercase tracking-tighter">ProLink</span>
                <span class="text-gray-300 font-light text-xl">//</span>
                <span class="font-bold text-[10px] uppercase tracking-widest text-[#FF5722] mt-1">Davis Master Bath</span>
            </div>
            <div id="master-status" class="status-badge badge-proposal">PROPOSAL</div>
        </div>
    </nav>

    <main class="max-w-md mx-auto p-4 space-y-8">

        <div id="view-bid" class="view-pane active space-y-6">
            <header><h2 class="text-4xl font-black italic uppercase tracking-tighter leading-none">123 Holland Road</h2></header>

            <div class="pro-card p-5 border-l-[12px] border-black flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=150&q=80" class="w-14 h-14 border-2 border-black object-cover grayscale">
                    <div>
                        <h3 class="font-black text-sm uppercase italic leading-none">Sorrenson Tile</h3>
                        <p class="text-[9px] mono text-gray-500 font-bold uppercase mt-1">Mike Sorrenson ‚Ä¢ LIC #99281-B</p>
                    </div>
                </div>
                <div class="status-badge bg-green-50 text-green-700 border-green-700">VERIFIED ‚úì</div>
            </div>

            <div class="pro-card p-6 space-y-6">
                <h3 class="mono text-[11px] font-black text-gray-400 uppercase tracking-widest border-b-2 border-dashed pb-2">Itemized Proposal</h3>
                <div class="space-y-6">
                    <div>
                        <div class="flex justify-between font-black text-xs uppercase mb-1"><span>Waterproofing System</span><span>$1,850</span></div>
                        <p class="text-[10px] text-gray-500 leading-tight italic">Demo of existing pan, installation of Kerdi-Board system and flood test.</p>
                    </div>
                    <div>
                        <div class="flex justify-between font-black text-xs uppercase mb-1"><span>Main Floor & Wall Tile</span><span>$2,400</span></div>
                        <p class="text-[10px] text-gray-500 leading-tight italic">Precision install of 12x24 Porcelain with 1/16" grout lines.</p>
                    </div>
                    <div>
                        <div class="flex justify-between font-black text-xs uppercase mb-1"><span>Logistics & Protection</span><span>$450</span></div>
                        <p class="text-[10px] text-gray-500 leading-tight italic">Dust mitigation, floor masking, and commercial disposal fees.</p>
                    </div>
                </div>
                <div class="bg-black text-white p-5 flex justify-between items-center shadow-[6px_6px_0px_#FF5722]">
                    <span class="mono text-[10px] font-bold uppercase italic tracking-widest">Total Investment</span>
                    <span class="text-3xl font-black italic">$4,700.00</span>
                </div>
                <button onclick="navigate('view-contract')" class="btn-main py-5 text-sm">Review & Sign Agreement</button>
            </div>
        </div>

        <div id="view-contract" class="view-pane space-y-6">
            <div class="pro-card p-6">
                <h2 class="font-black text-2xl italic uppercase mb-6 tracking-tighter">Fixed-Price Agreement</h2>
                <div class="bg-gray-50 border-2 border-black p-4 h-48 overflow-y-auto mb-6 text-[11px] font-bold leading-relaxed border-dashed">
                    <p class="mb-3">1. PERFORMANCE: Work performed according to TCNA standards.</p>
                    <p class="mb-3">2. MILESTONE PAYMENTS: Funds securely vaulted. Released to contractor solely upon photo-proof validation by homeowner.</p>
                    <p class="mb-3">3. MODIFICATIONS: Change orders required for any scope adjustments. Must be signed via ProLink.</p>
                    <p>4. WARRANTY: 1-Year limited workmanship warranty begins upon final ledger clearance.</p>
                </div>
                <div class="space-y-4">
                    <input type="text" placeholder="NAME ON CARD" class="border-2 border-black p-3 w-full mono text-xs uppercase outline-none focus:border-[#FF5722]">
                    <div class="flex gap-2">
                        <input type="text" placeholder="CARD NUMBER" class="border-2 border-black p-3 w-[70%] mono text-xs outline-none focus:border-[#FF5722]">
                        <input type="text" placeholder="CVC" class="border-2 border-black p-3 w-[30%] mono text-xs outline-none focus:border-[#FF5722]">
                    </div>
                    <div class="secure-tooltip mt-4">
                        <span class="text-blue-500 text-lg leading-none">üõ°Ô∏è</span>
                        <p class="text-[10px] text-slate-500 font-medium leading-tight"><strong>AUTHORIZATION ONLY:</strong> A temporary hold is placed for the project value. Funds remain in your control and do not transfer until you explicitly approve timeline milestones.</p>
                    </div>
                </div>
                <button onclick="navigate('view-heartbeat')" class="btn-main py-5 text-sm mt-8">Sign and Authorize Hold</button>
            </div>
        </div>

        <div id="view-heartbeat" class="view-pane space-y-8">
            
            <section id="action-zone" class="space-y-4">
                <h2 class="mono text-[11px] font-bold text-gray-500 uppercase tracking-widest px-1">Action Required</h2>
                
                <div id="card-payment" class="pro-card p-5 relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-[#FF5722] text-white px-3 py-1 mono text-[10px] font-bold italic shadow-sm">SQUARE SECURE</div>
                    <h3 class="font-black text-xl mb-1 italic uppercase">Release Milestone Funds</h3>
                    <p class="text-xs text-gray-500 mb-4 font-bold italic">Phase 1: Waterproofing & Inspection</p>
                    
                    <div class="flex items-center justify-between mb-4 bg-gray-50 p-4 border border-dashed border-gray-300">
                        <div>
                            <p class="text-[10px] mono text-gray-400 uppercase">Amount to Release</p>
                            <p class="text-2xl font-black">$1,850.00</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[10px] mono text-gray-400 uppercase tracking-tighter">Auth-Hold Status</p>
                            <p class="text-[10px] font-bold text-green-600 uppercase">Vaulted ‚úì</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-3 bg-blue-50 p-3 border border-blue-200 mb-4">
                        <span class="text-blue-900 font-bold leading-none">‚ìò</span>
                        <p class="text-[10px] text-blue-900 leading-tight"><strong>Sign-Off:</strong> Mike verified the flood test on 2/20. Release now authorized.</p>
                    </div>

                    <button onclick="approveItem('card-payment', 'Payment Released: Phase 1', '$1,850.00')" class="btn-main py-4 text-sm">Release Funds & Confirm</button>
                </div>

                <div id="card-change-order" class="pro-card p-4 flex justify-between items-center bg-amber-50 border-amber-400 shadow-[4px_4px_0px_#2A4494]">
                    <div class="max-w-[70%]">
                        <h4 class="font-black text-xs uppercase tracking-tight">Pending Change Order #03</h4>
                        <p class="text-[10px] text-gray-600 leading-tight font-bold">Custom niche tile upgrade (+ $180.00)</p>
                    </div>
                    <button onclick="approveItem('card-change-order', 'Change Order #03 Approved', '+$180.00')" class="bg-black text-white px-5 py-2 text-[10px] font-black uppercase active:scale-95 transition">Sign</button>
                </div>
            </section>

            <section class="space-y-4">
                <div class="flex justify-between items-end px-1">
                    <h2 class="mono text-[11px] font-bold text-gray-500 uppercase tracking-widest">Project Heartbeat</h2>
                </div>
                
                <div class="pro-card p-4 bg-gray-50 flex justify-between items-center border-dashed">
                    <div class="flex gap-3 items-center">
                        <span class="text-xl">üìÖ</span>
                        <p class="text-[10px] font-black uppercase italic tracking-tighter">Next Arrival: Tomorrow @ 8:15 AM</p>
                    </div>
                </div>

                <div class="timeline-container mt-6">
                    <div class="timeline-line"></div>
                    <div id="dynamic-log"></div> <div class="timeline-item">
                        <div class="timeline-dot dot-photo"></div>
                        <p class="mono text-[10px] text-gray-400 uppercase mb-2">Today @ 1:08 PM ‚Äî PROOF OF WORK</p>
                        <div class="pro-card overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1589939705384-5185138a047a?auto=format&fit=crop&w=600&q=80" class="w-full h-40 object-cover grayscale">
                            <div class="p-3 bg-white">
                                <p class="text-xs font-bold uppercase italic tracking-tighter">Verified Install: Kerdi-Board</p>
                                <p class="text-[10px] text-gray-500 font-bold">Captured at 123 Holland Rd. (Lat/Long Verified)</p>
                            </div>
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-dot dot-msg"></div>
                        <p class="mono text-[10px] text-gray-400 uppercase mb-2">Yesterday @ 4:30 PM ‚Äî MESSAGE LOG</p>
                        <div class="bg-black text-white p-4 shadow-[4px_4px_0px_#CCC] text-xs italic leading-relaxed font-bold">
                            "Flood test is holding perfectly. City inspector confirmed for tomorrow morning. Ready for your review in the app." ‚Äî Mike
                        </div>
                    </div>

                    <div class="timeline-item">
                        <div class="timeline-dot dot-photo"></div>
                        <p class="mono text-[10px] text-gray-400 uppercase mb-2">Feb 18 @ 9:15 AM ‚Äî PROOF OF WORK</p>
                        <div class="pro-card overflow-hidden">
                            <img src="https://images.unsplash.com/photo-1504307651254-35680f356f67?auto=format&fit=crop&w=600&q=80" class="w-full h-32 object-cover grayscale opacity-80">
                            <div class="p-3 bg-gray-50">
                                <p class="text-xs font-bold uppercase italic tracking-tighter">Phase 0: Demo Complete</p>
                                <p class="text-[10px] text-gray-500 font-bold">Old pan removed. Slab prepped.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div id="view-vault" class="view-pane space-y-6">
            
            <div id="vault-complete-ui" class="hidden space-y-6">
                <div class="pro-card p-10 bg-blue-900 text-white text-center shadow-[8px_8px_0px_#FF5722]">
                    <h2 class="text-4xl font-black italic uppercase leading-none mb-1 tracking-tighter">Project Ledger Closed</h2>
                    <p class="mono text-[10px] font-black uppercase tracking-widest text-blue-300">Certified Archive Locked</p>
                </div>
                
                <div class="pro-card p-6 bg-white border-l-[12px] border-[#FF5722]">
                    <h3 class="font-black text-xl uppercase italic mb-2 tracking-tight">Refer Mike Sorrenson?</h3>
                    <p class="text-[11px] text-gray-500 mb-6 italic font-bold">Satisfied with the build? Support Mike and help neighbors find verified pros by sharing your referral link.</p>
                    <div class="flex gap-2">
                        <button class="flex-1 bg-black text-white py-4 font-black text-[10px] uppercase">Leave Review</button>
                        <button class="flex-1 bg-white border-2 border-black py-4 font-black text-[10px] uppercase">Refer Friend</button>
                    </div>
                </div>
            </div>

            <div class="space-y-3">
                <div class="flex justify-between items-end mb-2">
                    <h3 class="mono text-[11px] font-black text-gray-400 uppercase tracking-widest">Financial & Tax Export</h3>
                    <span id="vault-pending-badge" class="bg-yellow-100 text-yellow-800 border border-yellow-800 px-2 py-1 mono text-[8px] font-bold uppercase">Docs Updating</span>
                </div>
                <div class="pro-card p-4 flex justify-between items-center bg-white hover:bg-gray-50 transition cursor-pointer">
                    <p class="text-xs font-black uppercase italic">Final Financial Summary</p>
                    <span class="text-xl">üìÑ</span>
                </div>
                <div class="pro-card p-4 flex justify-between items-center bg-white hover:bg-gray-50 transition cursor-pointer">
                    <p class="text-xs font-black uppercase italic">Executed Fixed-Price Agreement</p>
                    <span class="text-xl">‚öñÔ∏è</span>
                </div>
                <div class="pro-card p-4 flex justify-between items-center bg-white hover:bg-gray-50 transition cursor-pointer">
                    <p class="text-xs font-black uppercase italic">Verification Photo Log</p>
                    <span class="text-xl">üì∏</span>
                </div>
            </div>

            <button onclick="navigate('view-heartbeat')" class="w-full bg-transparent border-2 border-black py-4 font-black text-[11px] uppercase tracking-widest text-black mt-8 hover:bg-gray-100">
                ‚Üê Back to Heartbeat
            </button>
        </div>

    </main>

    <nav id="nav-footer" class="fixed bottom-6 inset-x-4 max-w-md mx-auto z-[100] flex gap-2 hidden">
        <button class="flex-[3] bg-black text-white py-5 font-black text-[11px] uppercase tracking-widest shadow-2xl flex items-center justify-center gap-2 active:scale-95 transition">
            <span class="text-lg leading-none">üí¨</span> Message Mike
        </button>
        <button id="btn-vault-toggle" onclick="navigate('view-vault')" class="flex-1 bg-white border-2 border-black py-5 font-black text-[11px] uppercase shadow-2xl flex items-center justify-center active:bg-gray-100 transition">
            üìÅ VAULT
        </button>
    </nav>

    <script>
        // Tracks state to know what elements to show
        let isProjectComplete = false;

        function navigate(viewId) {
            // Hide all views
            document.querySelectorAll('.view-pane').forEach(v => v.classList.remove('active'));
            // Show target view
            document.getElementById(viewId).classList.add('active');
            
            const status = document.getElementById('master-status');
            const footer = document.getElementById('nav-footer');
            const vaultBtn = document.getElementById('btn-vault-toggle');

            // Manage Top Badge & Footer visibility based on view/state
            if(viewId === 'view-bid' || viewId === 'view-contract') {
                status.innerText = "PROPOSAL";
                status.className = "status-badge badge-proposal";
                footer.style.display = 'none';
            } else {
                footer.style.display = 'flex';
                
                if (isProjectComplete) {
                    status.innerText = "COMPLETE";
                    status.className = "status-badge badge-complete";
                } else {
                    status.innerText = "IN-PROGRESS";
                    status.className = "status-badge badge-progress";
                }

                // Toggle logic for the Vault button in the footer
                if(viewId === 'view-vault') {
                    vaultBtn.innerHTML = "‚Üê LOG";
                    vaultBtn.setAttribute('onclick', "navigate('view-heartbeat')");
                } else {
                    vaultBtn.innerHTML = "üìÅ VAULT";
                    vaultBtn.setAttribute('onclick', "navigate('view-vault')");
                }
            }
            window.scrollTo(0,0);
        }

        function approveItem(cardId, title, amount) {
            const card = document.getElementById(cardId);
            
            // 1. Teleport Animation Out
            card.classList.add('teleport-out');
            
            setTimeout(() => {
                // 2. Hide Card from Action Zone
                card.style.display = 'none';
                
                // 3. Create Timeline Entry
                const log = document.getElementById('dynamic-log');
                const timestamp = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                const entry = document.createElement('div');
                entry.className = "timeline-item";
                entry.innerHTML = `
                    <div class="timeline-dot dot-action"></div>
                    <p class="mono text-[10px] text-green-600 font-bold uppercase mb-2">Today @ ${timestamp} ‚Äî VERIFIED ACTION</p>
                    <div class="pro-card p-4 log-entry-approved bg-green-50 shadow-[4px_4px_0px_#166534] border-green-800">
                        <p class="text-xs font-black uppercase italic">${title}</p>
                        <p class="text-[10px] font-bold text-gray-600 mt-1">${amount} logged securely to Project Ledger.</p>
                    </div>
                `;
                // 4. Inject at top of timeline
                log.prepend(entry);

                // 5. Check if Action Zone is empty
                const remainingActions = document.querySelectorAll('#action-zone .pro-card:not([style*="display: none"])');
                if (remainingActions.length === 0) {
                    triggerProjectCompletion();
                }
            }, 400); // Wait for CSS teleport animation to finish
        }

        function triggerProjectCompletion() {
            isProjectComplete = true;
            
            // Hide action zone container entirely
            document.getElementById('action-zone').style.display = 'none';
            
            // Update Top Badge immediately
            const status = document.getElementById('master-status');
            status.innerText = "COMPLETE";
            status.className = "status-badge badge-complete";
            
            // Update Vault Page contents dynamically
            document.getElementById('vault-complete-ui').classList.remove('hidden');
            document.getElementById('vault-pending-badge').style.display = 'none'; // Remove 'Docs Updating' badge
            
            // Optional: Inject a "Project Finished" capstone into the timeline
            const log = document.getElementById('dynamic-log');
            const entry = document.createElement('div');
            entry.className = "timeline-item";
            entry.innerHTML = `
                <div class="timeline-dot bg-black border-black"></div>
                <div class="bg-black text-white p-4 text-center mt-4">
                    <p class="text-sm font-black uppercase italic tracking-widest">Project Ledger Closed</p>
                    <p class="text-[10px] text-gray-400 mt-1 mono">All milestones validated & paid.</p>
                </div>
            `;
            log.prepend(entry);
        }
    </script>
</body>
</html>
